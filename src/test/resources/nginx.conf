# 负载均衡策略
upstream www.tomcatBbzzzs.cn {
  # 此时,8080和8088的权重比例为1:3,也就是说.
  # 此时8080上访问的概率为25%,8088访问概率为75%
  server localhost:8080 weight=1;
  server localhost:8088 weight=3;
}


server {
  listen 80;
  autoindex on;
  server_name www.tomcatBbzzzs.cn tomcatBbzzzs.cn;
  access_log /usr/local/nginx/logs/access.log combined;
  index index.html index.htm index.jsp index.php;
  if ( $query_string ~* ".*[\;'\<\>].*" ){
    return 404;
  }

  # 处理 / 请求
  location / {
    # 反向代理到负载均衡
    proxy_pass http://www.tomcatBbzzzs.cn;
  }

  location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|ico)$ {
    proxy_pass http://127.0.0.1:8080;
      expires 30d;
  }

  # 反向代理所有*.js,*.css结尾的请求,这里应该配置root,
  # 表示转发到本地目录下
  location ~ .*\.(js|css)?$ {
    proxy_pass http://127.0.0.1:8080;
      expires 7d;
  }

  # 反向代理所有.do结尾的请求
  location ~ .*\.do$ {
    # 反向代理到负载均衡
    proxy_pass http://www.tomcatBbzzzs.cn;
      expires 7d;
  }

}